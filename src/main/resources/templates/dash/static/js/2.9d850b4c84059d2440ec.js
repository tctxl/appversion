webpackJsonp([2],{M2OZ:function(e,t){},ecVz:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.app?a("div",{staticStyle:{display:"flex",height:"100%"}},[a("div",{staticStyle:{"max-width":"275px","min-width":"275px","background-color":"#f5f7fa","border-top-left-radius":"20px","border-bottom-left-radius":"20px",position:"relative"}},[a("div",{staticClass:"app-more"},[a("el-popover",{attrs:{placement:"top",trigger:"hover",width:"160"}},[a("p",[e._v("是否删除该应用？删除后相关数据将不可恢复！")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.deleteApp}},[e._v("确定")])],1),e._v(" "),a("i",{staticClass:"el-icon-delete",staticStyle:{padding:"10px",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"})])],1),e._v(" "),a("div",{staticStyle:{height:"100%",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",padding:"0 25px"}},[a("el-upload",{attrs:{action:e.$api+"api/dash/app/icon","list-type":"picture","show-file-list":!1,data:{token:e.$user.token},"on-success":e.handleAppIconSuccess,"auto-upload":!0}},[a("el-image",{staticClass:"el-upload-list__item-thumbnail",staticStyle:{width:"80px",height:"80px","border-radius":"50%",border:"3px solid #dedede","box-shadow":"0px 0px 20px 0px #bdbdbd"},attrs:{slot:"default",fit:"cover",src:e.$api+e.app.icon},slot:"default"},[a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v("\n            加载中"),a("span",{staticClass:"dot"},[e._v("...")])])])],1),e._v(" "),e.editAppName?a("div",{staticStyle:{"margin-top":"10px"}},[a("el-input",{staticStyle:{"font-size":"18px","text-align":"center"},attrs:{autofocus:!0},on:{blur:e.updateAppName},model:{value:e.app.appName,callback:function(t){e.$set(e.app,"appName",t)},expression:"app.appName"}})],1):a("div",{staticStyle:{"margin-top":"10px","font-size":"18px"},on:{click:function(t){e.editAppName=!0}}},[e._v(e._s(e.app.appName)+"\n      ")]),e._v(" "),e.editPlatform?a("div",{staticStyle:{"margin-top":"10px","font-size":"14px",color:"#777777"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.updatePlatform},model:{value:e.app.platform,callback:function(t){e.$set(e.app,"platform",t)},expression:"app.platform"}},[a("el-option",{attrs:{label:"Android",value:"Android"}}),e._v(" "),a("el-option",{attrs:{label:"iOS",value:"iOS"}})],1)],1):a("div",{staticStyle:{"margin-top":"10px","font-size":"14px",color:"#777777"},on:{click:function(t){e.editPlatform=!0}}},[e._v("\n        "+e._s(e.app.platform)+"\n      ")]),e._v(" "),e.editAppDesc?a("div",{staticStyle:{"margin-top":"10px",width:"100%"}},[a("el-input",{staticStyle:{"font-size":"12px","text-align":"center"},attrs:{resize:"none",autofocus:!0,type:"textarea"},on:{blur:e.updateAppDesc},model:{value:e.app.appDesc,callback:function(t){e.$set(e.app,"appDesc",t)},expression:"app.appDesc"}})],1):a("div",{staticStyle:{"margin-top":"10px","font-size":"14px",color:"#777777"},on:{click:function(t){e.editAppDesc=!0}}},[e._v("\n        "+e._s(e.app.appDesc)+"\n      ")]),e._v(" "),a("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[a("div",{staticStyle:{"font-size":"12px",color:"#aaa","text-align":"center"}},[e._v("\n          上传一个新版本\n        ")]),e._v(" "),a("el-button",{staticStyle:{"margin-top":"50px"},attrs:{slot:"reference",circle:"",icon:"el-icon-plus",type:"primary"},on:{click:e.loadVersions},slot:"reference"})],1)],1)]),e._v(" "),a("div",{staticStyle:{width:"99%",position:"relative"}},[a("div",{staticClass:"btn-close",on:{click:function(t){return e.$router.back()}}},[a("i",{staticClass:"el-icon-close",staticStyle:{"font-weight":"bold","margin-right":"10px","margin-top":"10px","font-size":"22px",color:"#fff"}})]),e._v(" "),a("div",{ref:"channels",staticStyle:{padding:"25px",width:"100%",height:"calc(100% - 160px)",position:"relative"}},[a("el-table",{staticStyle:{position:"absolute",width:"calc(100% - 100px)"},attrs:{height:"100%",stripe:!0,data:e.app.channels}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"channel",label:"渠道",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"升级提醒标题",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"升级提醒内容",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"升级类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?a("div",[e._v("非强制升级")]):e._e(),e._v(" "),2===t.row.type?a("div",[e._v("强制升级")]):e._e(),e._v(" "),3===t.row.type?a("div",[e._v("非强制升级-跳转浏览器")]):e._e(),e._v(" "),4===t.row.type?a("div",[e._v("强制升级-跳转浏览器")]):e._e(),e._v(" "),5===t.row.type?a("div",[e._v("非强制升级-跳转市场")]):e._e(),e._v(" "),6===t.row.type?a("div",[e._v("强制升级-跳转市场")]):e._e()]}}],null,!1,3875136041)}),e._v(" "),a("el-table-column",{attrs:{prop:"versionName",label:"版本号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nextId",label:"更新到"}}),e._v(" "),a("el-table-column",{attrs:{label:"版本链接"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{color:"#0d7f56",border:"none","text-decoration":"none"},attrs:{target:"_blank",href:t.row.url}},[e._v("下载")])]}}],null,!1,2065336063)}),e._v(" "),a("el-table-column",{attrs:{label:"对外分发"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!==t.row.appOpen?a("a",{staticStyle:{cursor:"pointer",color:"#0d7f56",border:"none","text-decoration":"none"},attrs:{target:"_blank"},on:{click:function(a){return e.shareApp(t.row)}}},[e._v("设置")]):a("div",[a("a",{staticStyle:{"text-decoration":"none",color:"#777777"},attrs:{href:e.$apk+"/s/"+e.$route.params.id}},[e._v("已分发")])])]}}],null,!1,2482289644)}),e._v(" "),a("el-table-column",{attrs:{label:"删除"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{cursor:"pointer",color:"#0d7f56",border:"none","text-decoration":"none"},attrs:{target:"_blank"},on:{click:function(a){return e.delChannel(t.row)}}},[e._v("删除")])]}}],null,!1,3985877805)})],1)],1),e._v(" "),a("div",{staticStyle:{padding:"25px",display:"flex","justify-content":"space-between","margin-top":"20px","align-items":"center"}},[a("el-button",{staticStyle:{width:"50px"},attrs:{type:"primary",disabled:!(e.pageNo>1)},on:{click:e.onPrev}},[a("i",{staticClass:"el-icon-arrow-left"})]),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#777777"}},[e._v("\n        "+e._s(e.pageNo)+"/"+e._s(e.pageCount)+"\n      ")]),e._v(" "),a("el-button",{staticStyle:{width:"50px"},attrs:{type:"primary",disabled:!(e.pageNo<e.pageCount)},on:{click:e.onNext}},[a("i",{staticClass:"el-icon-arrow-right"})])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"新建一个分发版本",visible:e.dialogCreateVersionVisible},on:{"update:visible":function(t){e.dialogCreateVersionVisible=t}}},[a("el-dialog",{attrs:{width:"30%",title:"新建版本号",visible:e.dialogCreateVersionCodeVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogCreateVersionCodeVisible=t}}},[a("div",[a("h4",[e._v("版本号设置")]),e._v(" "),a("div",[a("el-input",{attrs:{placeholder:"版本号名称，如：1.0.1,1.0.2..."},model:{value:e.newVersionName,callback:function(t){e.newVersionName=t},expression:"newVersionName"}})],1)]),e._v(" "),a("div",[a("el-button",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{type:"primary"},on:{click:e.createVersion}},[e._v("完成")])],1)]),e._v(" "),"Android"===e.app.platform?a("div",[a("el-upload",{attrs:{action:e.$api+"api/dash/app/version","list-type":"picture-card","show-file-list":!1,data:{appId:e.app.id,token:e.$user.token},accept:".apk","on-success":e.handleAppVersionSuccess,"auto-upload":!0}},[0===e.newVersion.url.length?a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}):a("i",{staticClass:"el-icon-check",attrs:{slot:"default"},slot:"default"})]),e._v(" "),e.newVersion.url.length>0?a("a",{ref:"newVersionUrl",staticStyle:{display:"none"},attrs:{href:e.$apk+e.newVersion.url}}):e._e()],1):a("div",[a("h4",[e._v("AppStore设置")]),e._v(" "),a("div",[a("el-input",{attrs:{placeholder:"应用在AppStore内的地址"},model:{value:e.newVersion.url,callback:function(t){e.$set(e.newVersion,"url",t)},expression:"newVersion.url"}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"Android"===e.app.platform,expression:"app.platform === 'Android'"}]},[a("h4",[e._v("渠道设置")]),e._v(" "),a("div",[a("el-input",{attrs:{placeholder:"渠道名称，用于不同渠道版本升级"},model:{value:e.newVersion.channel,callback:function(t){e.$set(e.newVersion,"channel",t)},expression:"newVersion.channel"}})],1)]),e._v(" "),a("div",[a("h4",[e._v("升级提醒设置")]),e._v(" "),a("div",[a("el-input",{attrs:{placeholder:"标题"},model:{value:e.newVersion.title,callback:function(t){e.$set(e.newVersion,"title",t)},expression:"newVersion.title"}})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-input",{attrs:{type:"textarea",resize:"none",placeholder:"内容"},model:{value:e.newVersion.content,callback:function(t){e.$set(e.newVersion,"content",t)},expression:"newVersion.content"}})],1)]),e._v(" "),a("div",[a("h4",[e._v("升级方式")]),e._v(" "),"Android"===e.app.platform?[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.newVersion.type,callback:function(t){e.$set(e.newVersion,"type",t)},expression:"newVersion.type"}},[a("el-option",{attrs:{label:"非强制升级",value:1}}),e._v(" "),a("el-option",{attrs:{label:"强制升级",value:2}}),e._v(" "),a("el-option",{attrs:{label:"非强制升级-跳转浏览器",value:3}}),e._v(" "),a("el-option",{attrs:{label:"强制升级-跳转浏览器",value:4}}),e._v(" "),a("el-option",{attrs:{label:"非强制升级-跳转市场",value:5}}),e._v(" "),a("el-option",{attrs:{label:"强制升级-跳转市场",value:6}})],1)]:[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.newVersion.type,callback:function(t){e.$set(e.newVersion,"type",t)},expression:"newVersion.type"}},[a("el-option",{attrs:{label:"非强制升级",value:1}}),e._v(" "),a("el-option",{attrs:{label:"强制升级",value:2}})],1)]],2),e._v(" "),a("div",[a("div",[a("h4",[e._v("版本号设置 "),a("span",{staticStyle:{"font-weight":"normal","font-size":"12px",color:"#0d7f56","text-underline":"#0d7f56",cursor:"pointer"},on:{click:function(t){e.dialogCreateVersionCodeVisible=!0}}},[e._v("(新建版本号)")])])]),e._v(" "),a("div",[a("el-select",{attrs:{placeholder:"如：1.0.0.20201018"},model:{value:e.newVersion.versionId,callback:function(t){e.$set(e.newVersion,"versionId",t)},expression:"newVersion.versionId"}},e._l(e.newVersion.versions,function(t){return a("el-option",{key:t.id,attrs:{label:t.versionName,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.versionName))]),e._v(" "),a("el-button",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"},attrs:{size:"mini"},on:{click:function(a){return a.stopPropagation(),e.delVersion(t)}}},[e._v("删除\n            ")])],1)}),1)],1)]),e._v(" "),a("div",[a("div",[a("el-button",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{type:"primary"},on:{click:e.createChannel}},[e._v("完成")])],1)])],1)],1):e._e()},staticRenderFns:[]};var n=a("VU/8")({name:"AppDetail",data:function(){return{app:null,pageNo:1,pageCount:1,editAppName:!1,editPlatform:!1,editAppDesc:!1,dialogCreateVersionVisible:!1,dialogCreateVersionCodeVisible:!1,newVersion:{channel:"default",title:"",url:"",content:"",type:1,versionId:"",versions:[]},newVersionName:""}},mounted:function(){this.loadAppDetail()},methods:{deleteApp:function(){var e=this,t=this;t.$confirm("删除应用后，相关的一切数据将不可恢复，是否删除？","危险",{confirmButtonText:"删除",type:"danger",callback:function(a){"confirm"===a&&t.$http.post("/api/dash/app/delete",{id:e.$route.params.id}).then(function(e){0===e.data.code&&t.$router.back()})}})},shareApp:function(e){var t=this;t.$http.post("/api/dash/app/share",{appId:this.$route.params.id,id:e.id}).then(function(a){if(0===a.data.code)for(var i=0;i<t.app.channels.length;i++){var n=t.app.channels[i];n.id!==e.id?n.appOpen=0:n.appOpen=1}})},delChannel:function(e){var t=this;t.$http.post("/api/dash/app/channel/delete",{appId:this.$route.params.id,id:e.id}).then(function(a){if(0===a.data.code)for(var i=0;i<t.app.channels.length;i++)if(t.app.channels[i].id===e.id){t.app.channels.splice(i,1);break}})},delVersion:function(e){var t=this;t.$http.post("/api/dash/app/version/delete",{appId:this.$route.params.id,id:e.id}).then(function(a){if(0===a.data.code)for(var i=0;i<t.newVersion.versions.length;i++)if(t.newVersion.versions[i].id===e.id){t.newVersion.versionId===e.id&&(t.newVersion.versionId=""),t.newVersion.versions.splice(i,1);break}})},createVersion:function(){var e=this;e.$http.post("/api/dash/app/version/create",{appId:this.$route.params.id,versionName:e.newVersionName}).then(function(t){0===t.data.code&&(e.newVersionName="",e.newVersion.versions.unshift(t.data.data)),e.dialogCreateVersionCodeVisible=!1})},loadVersions:function(){var e=this;e.dialogCreateVersionVisible=!0,e.$http.post("/api/dash/app/version/find",{appId:this.$route.params.id}).then(function(t){0===t.data.code&&e.$nextTick(function(){e.newVersion.versions=t.data.data,e.newVersion.versions.length>0&&(e.newVersion.versionId=e.newVersion.versions[0].id)})})},handleAppVersionSuccess:function(e,t){var a=this;305!==e.code?0===e.code&&(a.newVersion.url=e.data,a.$nextTick(function(){a.newVersion.url=a.$refs.newVersionUrl.href})):this.$router.push("/")},handleAppIconSuccess:function(e,t){var a=this;305!==e.code?0===e.code&&a.$http.post("/api/dash/app/update",{id:this.$route.params.id,icon:e.data}).then(function(e){0===e.data.code&&a.$nextTick(function(){a.app.icon=e.data.data.icon})}):this.$router.push("/")},createChannel:function(){var e=this,t={appId:this.$route.params.id,channel:e.newVersion.channel,title:e.newVersion.title,url:e.newVersion.url,content:e.newVersion.content,type:e.newVersion.type,versionId:e.newVersion.versionId};e.$http.post("/api/dash/app/channel/create",t).then(function(t){0===t.data.code&&(e.newVersion={channel:"default",title:"",url:"",content:"",type:1,version:{versionName:"",versionCode:0},versions:[]},t.data.data.appOpen=0,e.app.channels.unshift(t.data.data),e.dialogCreateVersionVisible=!1),e.editAppName=!1})},updateAppName:function(){var e=this;e.$http.post("/api/dash/app/update",{id:this.$route.params.id,appName:this.app.appName}).then(function(t){0===t.data.code&&(e.app.appName=t.data.data.appName),e.editAppName=!1})},updateAppDesc:function(){var e=this;e.$http.post("/api/dash/app/update",{id:this.$route.params.id,appDesc:this.app.appDesc}).then(function(t){0===t.data.code&&(e.app.appDesc=t.data.data.appDesc),e.editAppDesc=!1})},updatePlatform:function(){var e=this;e.$http.post("/api/dash/app/update",{id:this.$route.params.id,platform:this.app.platform}).then(function(t){0===t.data.code&&(e.app.platform=t.data.data.platform),e.editPlatform=!1})},onPrev:function(){this.pageNo-=1,this.loadAppDetail()},onNext:function(){this.pageNo+=1,this.loadAppDetail()},loadAppDetail:function(){var e=this;e.$http.post("/api/dash/app/detail",{id:this.$route.params.id,pageNo:this.pageNo}).then(function(t){0===t.data.code&&(e.app=t.data.data.data,e.pageNo=t.data.data.pageNo,e.pageCount=t.data.data.pageCount)})}}},i,!1,function(e){a("M2OZ")},"data-v-9996b0be",null);t.default=n.exports}});
//# sourceMappingURL=2.9d850b4c84059d2440ec.js.map